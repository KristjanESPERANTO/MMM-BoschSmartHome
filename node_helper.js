(()=>{"use strict";var e={944:function(e,i,t){var o=this&&this.__awaiter||function(e,i,t,o){return new(t||(t=Promise))((function(s,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function c(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var i;e.done?s(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,c)}l((o=o.apply(e,i||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const s=t(543),n=t(747),r=t(230);e.exports=s.create({cert:null,key:null,logger:null,client:null,rooms:null,start(){this.cert=n.readFileSync(`${__dirname}/client-cert.pem`).toString(),this.key=n.readFileSync(`${__dirname}/client-key.pem`).toString(),this.logger=new r.DefaultLogger,this.logger.fine=()=>{},this.logger.info=e=>{e.indexOf("Using existing certificate")>=0||e.indexOf("Check if client with identifier")>=0||console.info(e)},console.log(`${this.name} helper method started...`)},establishConnection(e){return o(this,void 0,void 0,(function*(){if(!this.client)try{const i=r.BoschSmartHomeBridgeBuilder.builder().withHost(e.host).withClientCert(this.cert).withClientPrivateKey(this.key).withLogger(this.logger).build();yield i.pairIfNeeded(e.name,e.identifier,e.password).toPromise(),this.client=i.getBshcClient()}catch(e){console.log(e)}}))},loadData(){return o(this,void 0,void 0,(function*(){try{if(!this.rooms){const{parsedResponse:e}=yield this.client.getRooms().toPromise();this.rooms=e}const{parsedResponse:e}=yield this.client.getDevices().toPromise(),{parsedResponse:i}=yield this.client.getDevicesServices().toPromise();for(const t of e)t.services=i.filter((e=>e.deviceId===t.id));for(const i of this.rooms)i.devices=e.filter((e=>e.roomId===i.id))}catch(e){console.error(e.message)}}))},socketNotificationReceived(e,i){return o(this,void 0,void 0,(function*(){if("GET_STATUS"===e){if(i.mocked){const e=n.readFileSync(__dirname+"/debugResponse.json").toString();this.rooms=JSON.parse(e)}else yield this.establishConnection(i),yield this.loadData(),i.debug&&n.writeFileSync(__dirname+"/debugResponse.json",JSON.stringify(this.rooms));this.sendSocketNotification("STATUS_RESULT",this.rooms)}else console.warn(`${e} is invalid notification`)}))}})},230:e=>{e.exports=require("bosch-smart-home-bridge")},747:e=>{e.exports=require("fs")},543:e=>{e.exports=require("node_helper")}},i={},t=function t(o){var s=i[o];if(void 0!==s)return s.exports;var n=i[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}(944);module.exports=t})();