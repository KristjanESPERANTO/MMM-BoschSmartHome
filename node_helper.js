module.exports=(()=>{"use strict";var e={685:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(s,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function c(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,c)}l((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=i(543),n=i(747),r=i(230);e.exports=s.create({cert:null,key:null,logger:null,client:null,rooms:null,start(){this.cert=n.readFileSync(`${__dirname}/client-cert.pem`).toString(),this.key=n.readFileSync(`${__dirname}/client-key.pem`).toString(),this.logger=new r.DefaultLogger,this.logger.fine=()=>{},this.logger.info=e=>{e.indexOf("Using existing certificate")>=0||e.indexOf("Check if client with identifier")>=0||console.info(e)},console.log(`${this.name} helper method started...`)},establishConnection(e){return o(this,void 0,void 0,(function*(){if(!this.client)try{const t=r.BoschSmartHomeBridgeBuilder.builder().withHost(e.host).withClientCert(this.cert).withClientPrivateKey(this.key).withLogger(this.logger).build();yield t.pairIfNeeded(e.name,e.identifier,e.password).toPromise(),this.client=t.getBshcClient()}catch(e){console.log(e)}}))},loadData(){return o(this,void 0,void 0,(function*(){try{if(!this.rooms){const{parsedResponse:e}=yield this.client.getRooms().toPromise();this.rooms=e}const{parsedResponse:e}=yield this.client.getDevices().toPromise(),{parsedResponse:t}=yield this.client.getDevicesServices().toPromise();for(const i of e)i.services=t.filter((e=>e.deviceId===i.id));for(const t of this.rooms)t.devices=e.filter((e=>e.roomId===t.id))}catch(e){console.error(e.message)}}))},socketNotificationReceived(e,t){return o(this,void 0,void 0,(function*(){if("GET_STATUS"===e){if(t.mocked){const e=n.readFileSync(__dirname+"/debugResponse.json");this.rooms=JSON.parse(e)}else yield this.establishConnection(t),yield this.loadData(),t.debug&&n.writeFileSync(__dirname+"/debugResponse.json",JSON.stringify(this.rooms));this.sendSocketNotification("STATUS_RESULT",this.rooms)}else console.warn(`${e} is invalid notification`)}))}})},230:e=>{e.exports=require("bosch-smart-home-bridge")},747:e=>{e.exports=require("fs")},543:e=>{e.exports=require("node_helper")}},t={};return function i(o){if(t[o])return t[o].exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,i),s.exports}(685)})();